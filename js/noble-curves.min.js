var nobleCurves=(()=>{var ze=Object.defineProperty;var Us=Object.getOwnPropertyDescriptor;var Ds=Object.getOwnPropertyNames;var qs=Object.prototype.hasOwnProperty;var Pn=(e,t)=>{for(var r in t)ze(e,r,{get:t[r],enumerable:!0})},Ns=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ds(t))!qs.call(e,s)&&s!==r&&ze(e,s,{get:()=>t[s],enumerable:!(n=Us(t,s))||n.enumerable});return e};var ks=e=>Ns(ze({},"__esModule",{value:!0}),e);var uf={};Pn(uf,{Field:()=>it,babyjubjub:()=>ls,brainpoolP256r1:()=>hs,brainpoolP384r1:()=>bs,brainpoolP512r1:()=>xs,decaf448:()=>ss,ed25519:()=>Dr,ed25519ctx:()=>qr,ed25519ph:()=>Nr,ed448:()=>es,ed448ph:()=>ns,jubjub:()=>us,p256:()=>ms,p384:()=>gs,p521:()=>ys,ristretto255:()=>Cr,schnorr:()=>Is,secp256k1:()=>vs,utils:()=>df,webcrypto:()=>Kn,x25519:()=>kr,x448:()=>rs});function Vt(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function at(e,t=""){if(!Number.isSafeInteger(e)||e<0){let r=t&&`"${t}" `;throw new Error(`${r}expected integer >0, got ${e}`)}}function L(e,t,r=""){let n=Vt(e),s=e?.length,o=t!==void 0;if(!n||o&&s!==t){let f=r&&`"${r}" `,c=o?` of length ${t}`:"",i=n?`length=${s}`:`type=${typeof e}`;throw new Error(f+"expected Uint8Array"+c+", got "+i)}return e}function Ae(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");at(e.outputLen),at(e.blockLen)}function lt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Jt(e,t){L(e,void 0,"digestInto() output");let r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function jn(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Q(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function vt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rt(e,t){return e<<32-t|e>>>t}var Cs=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Zs(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Ks(e){for(let t=0;t<e.length;t++)e[t]=Zs(e[t]);return e}var $e=Cs?e=>e:Ks,Yn=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Ms=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ht(e){if(L(e),Yn)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Ms[e[r]];return t}var Bt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Xn(e){if(e>=Bt._0&&e<=Bt._9)return e-Bt._0;if(e>=Bt.A&&e<=Bt.F)return e-(Bt.A-10);if(e>=Bt.a&&e<=Bt.f)return e-(Bt.a-10)}function ot(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Yn)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let s=0,o=0;s<r;s++,o+=2){let f=Xn(e.charCodeAt(o)),c=Xn(e.charCodeAt(o+1));if(f===void 0||c===void 0){let i=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+i+'" at index '+o)}n[s]=f*16+c}return n}function Y(...e){let t=0;for(let n=0;n<e.length;n++){let s=e[n];L(s),t+=s.length}let r=new Uint8Array(t);for(let n=0,s=0;n<e.length;n++){let o=e[n];r.set(o,s),s+=o.length}return r}function bt(e,t={}){let r=(s,o)=>e(o).update(s).digest(),n=e(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=s=>e(s),Object.assign(r,t),Object.freeze(r)}function xt(e=32){let t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}var te=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function Wn(e,t,r){return e&t^~e&r}function zn(e,t,r){return e&t^e&r^t&r}var le=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,n,s){this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(t),this.view=vt(this.buffer)}update(t){lt(this),L(t);let{view:r,buffer:n,blockLen:s}=this,o=t.length;for(let f=0;f<o;){let c=Math.min(s-this.pos,o-f);if(c===s){let i=vt(t);for(;s<=o-f;f+=s)this.process(i,f);continue}n.set(t.subarray(f,f+c),this.pos),this.pos+=c,f+=c,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){lt(this),Jt(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:s,isLE:o}=this,{pos:f}=this;r[f++]=128,Q(this.buffer.subarray(f)),this.padOffset>s-f&&(this.process(n,0),f=0);for(let h=f;h<s;h++)r[h]=0;n.setBigUint64(s-8,BigInt(this.length*8),o),this.process(n,0);let c=vt(t),i=this.outputLen;if(i%4)throw new Error("_sha2: outputLen must be aligned to 32bit");let a=i/4,l=this.get();if(a>l.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<a;h++)c.setUint32(4*h,l[h],o)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());let{blockLen:r,buffer:n,length:s,finished:o,destroyed:f,pos:c}=this;return t.destroyed=f,t.finished=o,t.length=s,t.pos=c,s%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}},pt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var F=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),J=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var Oe=BigInt(4294967295),$n=BigInt(32);function Qe(e,t=!1){return t?{h:Number(e&Oe),l:Number(e>>$n&Oe)}:{h:Number(e>>$n&Oe)|0,l:Number(e&Oe)|0}}function Re(e,t=!1){let r=e.length,n=new Uint32Array(r),s=new Uint32Array(r);for(let o=0;o<r;o++){let{h:f,l:c}=Qe(e[o],t);[n[o],s[o]]=[f,c]}return[n,s]}var Fe=(e,t,r)=>e>>>r,Je=(e,t,r)=>e<<32-r|t>>>r,Ot=(e,t,r)=>e>>>r|t<<32-r,Rt=(e,t,r)=>e<<32-r|t>>>r,he=(e,t,r)=>e<<64-r|t>>>r-32,be=(e,t,r)=>e>>>r-32|t<<64-r;var Qn=(e,t,r)=>e<<r|t>>>32-r,Fn=(e,t,r)=>t<<r|e>>>32-r,Jn=(e,t,r)=>t<<r-32|e>>>64-r,tr=(e,t,r)=>e<<r-32|t>>>64-r;function mt(e,t,r,n){let s=(t>>>0)+(n>>>0);return{h:e+r+(s/2**32|0)|0,l:s|0}}var tn=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),en=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,er=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),nr=(e,t,r,n,s)=>t+r+n+s+(e/2**32|0)|0,rr=(e,t,r,n,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(s>>>0),sr=(e,t,r,n,s,o)=>t+r+n+s+o+(e/2**32|0)|0;var Gs=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Tt=new Uint32Array(64),nn=class extends le{constructor(t){super(64,t,8,!1)}get(){let{A:t,B:r,C:n,D:s,E:o,F:f,G:c,H:i}=this;return[t,r,n,s,o,f,c,i]}set(t,r,n,s,o,f,c,i){this.A=t|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=o|0,this.F=f|0,this.G=c|0,this.H=i|0}process(t,r){for(let h=0;h<16;h++,r+=4)Tt[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let d=Tt[h-15],u=Tt[h-2],p=rt(d,7)^rt(d,18)^d>>>3,_=rt(u,17)^rt(u,19)^u>>>10;Tt[h]=_+Tt[h-7]+p+Tt[h-16]|0}let{A:n,B:s,C:o,D:f,E:c,F:i,G:a,H:l}=this;for(let h=0;h<64;h++){let d=rt(c,6)^rt(c,11)^rt(c,25),u=l+d+Wn(c,i,a)+Gs[h]+Tt[h]|0,_=(rt(n,2)^rt(n,13)^rt(n,22))+zn(n,s,o)|0;l=a,a=i,i=c,c=f+u|0,f=o,o=s,s=n,n=u+_|0}n=n+this.A|0,s=s+this.B|0,o=o+this.C|0,f=f+this.D|0,c=c+this.E|0,i=i+this.F|0,a=a+this.G|0,l=l+this.H|0,this.set(n,s,o,f,c,i,a,l)}roundClean(){Q(Tt)}destroy(){this.set(0,0,0,0,0,0,0,0),Q(this.buffer)}},rn=class extends nn{A=pt[0]|0;B=pt[1]|0;C=pt[2]|0;D=pt[3]|0;E=pt[4]|0;F=pt[5]|0;G=pt[6]|0;H=pt[7]|0;constructor(){super(32)}};var fr=Re(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Ps=fr[0],Xs=fr[1],Lt=new Uint32Array(80),Ht=new Uint32Array(80),Te=class extends le{constructor(t){super(128,t,16,!1)}get(){let{Ah:t,Al:r,Bh:n,Bl:s,Ch:o,Cl:f,Dh:c,Dl:i,Eh:a,El:l,Fh:h,Fl:d,Gh:u,Gl:p,Hh:_,Hl:y}=this;return[t,r,n,s,o,f,c,i,a,l,h,d,u,p,_,y]}set(t,r,n,s,o,f,c,i,a,l,h,d,u,p,_,y){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=o|0,this.Cl=f|0,this.Dh=c|0,this.Dl=i|0,this.Eh=a|0,this.El=l|0,this.Fh=h|0,this.Fl=d|0,this.Gh=u|0,this.Gl=p|0,this.Hh=_|0,this.Hl=y|0}process(t,r){for(let w=0;w<16;w++,r+=4)Lt[w]=t.getUint32(r),Ht[w]=t.getUint32(r+=4);for(let w=16;w<80;w++){let O=Lt[w-15]|0,D=Ht[w-15]|0,C=Ot(O,D,1)^Ot(O,D,8)^Fe(O,D,7),k=Rt(O,D,1)^Rt(O,D,8)^Je(O,D,7),B=Lt[w-2]|0,v=Ht[w-2]|0,N=Ot(B,v,19)^he(B,v,61)^Fe(B,v,6),Z=Rt(B,v,19)^be(B,v,61)^Je(B,v,6),H=er(k,Z,Ht[w-7],Ht[w-16]),m=nr(H,C,N,Lt[w-7],Lt[w-16]);Lt[w]=m|0,Ht[w]=H|0}let{Ah:n,Al:s,Bh:o,Bl:f,Ch:c,Cl:i,Dh:a,Dl:l,Eh:h,El:d,Fh:u,Fl:p,Gh:_,Gl:y,Hh:g,Hl:S}=this;for(let w=0;w<80;w++){let O=Ot(h,d,14)^Ot(h,d,18)^he(h,d,41),D=Rt(h,d,14)^Rt(h,d,18)^be(h,d,41),C=h&u^~h&_,k=d&p^~d&y,B=rr(S,D,k,Xs[w],Ht[w]),v=sr(B,g,O,C,Ps[w],Lt[w]),N=B|0,Z=Ot(n,s,28)^he(n,s,34)^he(n,s,39),H=Rt(n,s,28)^be(n,s,34)^be(n,s,39),m=n&o^n&c^o&c,b=s&f^s&i^f&i;g=_|0,S=y|0,_=u|0,y=p|0,u=h|0,p=d|0,{h,l:d}=mt(a|0,l|0,v|0,N|0),a=c|0,l=i|0,c=o|0,i=f|0,o=n|0,f=s|0;let x=tn(N,H,b);n=en(x,v,Z,m),s=x|0}({h:n,l:s}=mt(this.Ah|0,this.Al|0,n|0,s|0)),{h:o,l:f}=mt(this.Bh|0,this.Bl|0,o|0,f|0),{h:c,l:i}=mt(this.Ch|0,this.Cl|0,c|0,i|0),{h:a,l}=mt(this.Dh|0,this.Dl|0,a|0,l|0),{h,l:d}=mt(this.Eh|0,this.El|0,h|0,d|0),{h:u,l:p}=mt(this.Fh|0,this.Fl|0,u|0,p|0),{h:_,l:y}=mt(this.Gh|0,this.Gl|0,_|0,y|0),{h:g,l:S}=mt(this.Hh|0,this.Hl|0,g|0,S|0),this.set(n,s,o,f,c,i,a,l,h,d,u,p,_,y,g,S)}roundClean(){Q(Lt,Ht)}destroy(){Q(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},sn=class extends Te{Ah=J[0]|0;Al=J[1]|0;Bh=J[2]|0;Bl=J[3]|0;Ch=J[4]|0;Cl=J[5]|0;Dh=J[6]|0;Dl=J[7]|0;Eh=J[8]|0;El=J[9]|0;Fh=J[10]|0;Fl=J[11]|0;Gh=J[12]|0;Gl=J[13]|0;Hh=J[14]|0;Hl=J[15]|0;constructor(){super(64)}},on=class extends Te{Ah=F[0]|0;Al=F[1]|0;Bh=F[2]|0;Bl=F[3]|0;Ch=F[4]|0;Cl=F[5]|0;Dh=F[6]|0;Dl=F[7]|0;Eh=F[8]|0;El=F[9]|0;Fh=F[10]|0;Fl=F[11]|0;Gh=F[12]|0;Gl=F[13]|0;Hh=F[14]|0;Hl=F[15]|0;constructor(){super(48)}};var Ut=bt(()=>new rn,te(1));var Dt=bt(()=>new sn,te(3)),Le=bt(()=>new on,te(2));var cn=BigInt(0),fn=BigInt(1);function Et(e,t=""){if(typeof e!="boolean"){let r=t&&`"${t}" `;throw new Error(r+"expected boolean, got type="+typeof e)}return e}function ir(e){if(typeof e=="bigint"){if(!He(e))throw new Error("positive bigint expected, got "+e)}else at(e);return e}function xe(e){let t=ir(e).toString(16);return t.length&1?"0"+t:t}function cr(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?cn:BigInt("0x"+e)}function qt(e){return cr(ht(e))}function dt(e){return cr(ht(Gt(L(e)).reverse()))}function Ue(e,t){at(t),e=ir(e);let r=ot(e.toString(16).padStart(t*2,"0"));if(r.length!==t)throw new Error("number too large");return r}function pe(e,t){return Ue(e,t).reverse()}function De(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}function Gt(e){return Uint8Array.from(e)}function Nt(e){return Uint8Array.from(e,(t,r)=>{let n=t.charCodeAt(0);if(t.length!==1||n>127)throw new Error(`string contains non-ASCII character "${e[r]}" with code ${n} at position ${r}`);return n})}var He=e=>typeof e=="bigint"&&cn<=e;function js(e,t,r){return He(e)&&He(t)&&He(r)&&t<=e&&e<r}function kt(e,t,r,n){if(!js(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function an(e){let t;for(t=0;e>cn;e>>=fn,t+=1);return t}var me=e=>(fn<<BigInt(e))-fn;function ar(e,t,r){if(at(e,"hashLen"),at(t,"qByteLen"),typeof r!="function")throw new Error("hmacFn must be a function");let n=y=>new Uint8Array(y),s=Uint8Array.of(),o=Uint8Array.of(0),f=Uint8Array.of(1),c=1e3,i=n(e),a=n(e),l=0,h=()=>{i.fill(1),a.fill(0),l=0},d=(...y)=>r(a,Y(i,...y)),u=(y=s)=>{a=d(o,y),i=d(),y.length!==0&&(a=d(f,y),i=d())},p=()=>{if(l++>=c)throw new Error("drbg: tried max amount of iterations");let y=0,g=[];for(;y<t;){i=d();let S=i.slice();g.push(S),y+=i.length}return Y(...g)};return(y,g)=>{h(),u(y);let S;for(;!(S=g(p()));)u();return h(),S}}function gt(e,t={},r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(o,f,c){let i=e[o];if(c&&i===void 0)return;let a=typeof i;if(a!==f||i===null)throw new Error(`param "${o}" is invalid: expected ${f}, got ${a}`)}let s=(o,f)=>Object.entries(o).forEach(([c,i])=>n(c,i,f));s(t,!1),s(r,!0)}var dn=()=>{throw new Error("not implemented")};function ee(e){let t=new WeakMap;return(r,...n)=>{let s=t.get(r);if(s!==void 0)return s;let o=e(r,...n);return t.set(r,o),o}}var ft=BigInt(0),tt=BigInt(1),Pt=BigInt(2),lr=BigInt(3),hr=BigInt(4),br=BigInt(5),Ys=BigInt(7),xr=BigInt(8),Ws=BigInt(9),pr=BigInt(16);function V(e,t){let r=e%t;return r>=ft?r:t+r}function K(e,t,r){let n=e;for(;t-- >ft;)n*=n,n%=r;return n}function dr(e,t){if(e===ft)throw new Error("invert: expected non-zero number");if(t<=ft)throw new Error("invert: expected positive modulus, got "+t);let r=V(e,t),n=t,s=ft,o=tt,f=tt,c=ft;for(;r!==ft;){let a=n/r,l=n%r,h=s-f*a,d=o-c*a;n=r,r=l,s=f,o=c,f=h,c=d}if(n!==tt)throw new Error("invert: does not exist");return V(s,t)}function ln(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function mr(e,t){let r=(e.ORDER+tt)/hr,n=e.pow(t,r);return ln(e,n,t),n}function zs(e,t){let r=(e.ORDER-br)/xr,n=e.mul(t,Pt),s=e.pow(n,r),o=e.mul(t,s),f=e.mul(e.mul(o,Pt),s),c=e.mul(o,e.sub(f,e.ONE));return ln(e,c,t),c}function $s(e){let t=it(e),r=gr(e),n=r(t,t.neg(t.ONE)),s=r(t,n),o=r(t,t.neg(n)),f=(e+Ys)/pr;return(c,i)=>{let a=c.pow(i,f),l=c.mul(a,n),h=c.mul(a,s),d=c.mul(a,o),u=c.eql(c.sqr(l),i),p=c.eql(c.sqr(h),i);a=c.cmov(a,l,u),l=c.cmov(d,h,p);let _=c.eql(c.sqr(l),i),y=c.cmov(a,l,_);return ln(c,y,i),y}}function gr(e){if(e<lr)throw new Error("sqrt is not defined for small field");let t=e-tt,r=0;for(;t%Pt===ft;)t/=Pt,r++;let n=Pt,s=it(e);for(;ur(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return mr;let o=s.pow(n,t),f=(t+tt)/Pt;return function(i,a){if(i.is0(a))return a;if(ur(i,a)!==1)throw new Error("Cannot find square root");let l=r,h=i.mul(i.ONE,o),d=i.pow(a,t),u=i.pow(a,f);for(;!i.eql(d,i.ONE);){if(i.is0(d))return i.ZERO;let p=1,_=i.sqr(d);for(;!i.eql(_,i.ONE);)if(p++,_=i.sqr(_),p===l)throw new Error("Cannot find square root");let y=tt<<BigInt(l-p-1),g=i.pow(h,y);l=p,h=i.sqr(g),d=i.mul(d,h),u=i.mul(u,g)}return u}}function Qs(e){return e%hr===lr?mr:e%xr===br?zs:e%pr===Ws?$s(e):gr(e)}var ut=(e,t)=>(V(e,t)&tt)===tt,Fs=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function hn(e){let t={ORDER:"bigint",BYTES:"number",BITS:"number"},r=Fs.reduce((n,s)=>(n[s]="function",n),t);return gt(e,r),e}function Js(e,t,r){if(r<ft)throw new Error("invalid exponent, negatives unsupported");if(r===ft)return e.ONE;if(r===tt)return t;let n=e.ONE,s=t;for(;r>ft;)r&tt&&(n=e.mul(n,s)),s=e.sqr(s),r>>=tt;return n}function ne(e,t,r=!1){let n=new Array(t.length).fill(r?e.ZERO:void 0),s=t.reduce((f,c,i)=>e.is0(c)?f:(n[i]=f,e.mul(f,c)),e.ONE),o=e.inv(s);return t.reduceRight((f,c,i)=>e.is0(c)?f:(n[i]=e.mul(f,n[i]),e.mul(f,c)),o),n}function ur(e,t){let r=(e.ORDER-tt)/Pt,n=e.pow(t,r),s=e.eql(n,e.ONE),o=e.eql(n,e.ZERO),f=e.eql(n,e.neg(e.ONE));if(!s&&!o&&!f)throw new Error("invalid Legendre symbol result");return s?1:o?0:-1}function to(e,t){t!==void 0&&at(t);let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}var un=class{ORDER;BITS;BYTES;isLE;ZERO=ft;ONE=tt;_lengths;_sqrt;_mod;constructor(t,r={}){if(t<=ft)throw new Error("invalid field: expected ORDER > 0, got "+t);let n;this.isLE=!1,r!=null&&typeof r=="object"&&(typeof r.BITS=="number"&&(n=r.BITS),typeof r.sqrt=="function"&&(this.sqrt=r.sqrt),typeof r.isLE=="boolean"&&(this.isLE=r.isLE),r.allowedLengths&&(this._lengths=r.allowedLengths?.slice()),typeof r.modFromBytes=="boolean"&&(this._mod=r.modFromBytes));let{nBitLength:s,nByteLength:o}=to(t,n);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=s,this.BYTES=o,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return V(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return ft<=t&&t<this.ORDER}is0(t){return t===ft}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&tt)===tt}neg(t){return V(-t,this.ORDER)}eql(t,r){return t===r}sqr(t){return V(t*t,this.ORDER)}add(t,r){return V(t+r,this.ORDER)}sub(t,r){return V(t-r,this.ORDER)}mul(t,r){return V(t*r,this.ORDER)}pow(t,r){return Js(this,t,r)}div(t,r){return V(t*dr(r,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,r){return t+r}subN(t,r){return t-r}mulN(t,r){return t*r}inv(t){return dr(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=Qs(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?pe(t,this.BYTES):Ue(t,this.BYTES)}fromBytes(t,r=!1){L(t);let{_lengths:n,BYTES:s,isLE:o,ORDER:f,_mod:c}=this;if(n){if(!n.includes(t.length)||t.length>s)throw new Error("Field.fromBytes: expected "+n+" bytes, got "+t.length);let a=new Uint8Array(s);a.set(t,o?0:a.length-t.length),t=a}if(t.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+t.length);let i=o?dt(t):qt(t);if(c&&(i=V(i,f)),!r&&!this.isValid(i))throw new Error("invalid field element: outside of range 0..ORDER");return i}invertBatch(t){return ne(this,t)}cmov(t,r,n){return n?r:t}};function it(e,t={}){return new un(e,t)}function yr(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function bn(e){let t=yr(e);return t+Math.ceil(t/2)}function qe(e,t,r=!1){L(e);let n=e.length,s=yr(t),o=bn(t);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);let f=r?dt(e):qt(e),c=V(f,t-tt)+tt;return r?pe(c,s):Ue(c,s)}var re=BigInt(0),Xt=BigInt(1);function ge(e,t){let r=t.negate();return e?r:t}function jt(e,t){let r=ne(e.Fp,t.map(n=>n.Z));return t.map((n,s)=>e.fromAffine(n.toAffine(r[s])))}function Er(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function xn(e,t){Er(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1),s=2**e,o=me(e),f=BigInt(e);return{windows:r,windowSize:n,mask:o,maxNumber:s,shiftBy:f}}function wr(e,t,r){let{windowSize:n,mask:s,maxNumber:o,shiftBy:f}=r,c=Number(e&s),i=e>>f;c>n&&(c-=o,i+=Xt);let a=t*n,l=a+Math.abs(c)-1,h=c===0,d=c<0,u=t%2!==0;return{nextN:i,offset:l,isZero:h,isNeg:d,isNegF:u,offsetF:a}}var pn=new WeakMap,_r=new WeakMap;function mn(e){return _r.get(e)||1}function Br(e){if(e!==re)throw new Error("invalid wNAF")}var se=class{BASE;ZERO;Fn;bits;constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let s=t;for(;r>re;)r&Xt&&(n=n.add(s)),s=s.double(),r>>=Xt;return n}precomputeWindow(t,r){let{windows:n,windowSize:s}=xn(r,this.bits),o=[],f=t,c=f;for(let i=0;i<n;i++){c=f,o.push(c);for(let a=1;a<s;a++)c=c.add(f),o.push(c);f=c.double()}return o}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,o=this.BASE,f=xn(t,this.bits);for(let c=0;c<f.windows;c++){let{nextN:i,offset:a,isZero:l,isNeg:h,isNegF:d,offsetF:u}=wr(n,c,f);n=i,l?o=o.add(ge(d,r[u])):s=s.add(ge(h,r[a]))}return Br(n),{p:s,f:o}}wNAFUnsafe(t,r,n,s=this.ZERO){let o=xn(t,this.bits);for(let f=0;f<o.windows&&n!==re;f++){let{nextN:c,offset:i,isZero:a,isNeg:l}=wr(n,f,o);if(n=c,!a){let h=r[i];s=s.add(l?h.negate():h)}}return Br(n),s}getPrecomputes(t,r,n){let s=pn.get(r);return s||(s=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(s=n(s)),pn.set(r,s))),s}cached(t,r,n){let s=mn(t);return this.wNAF(s,this.getPrecomputes(s,t,n),r)}unsafe(t,r,n,s){let o=mn(t);return o===1?this._unsafeLadder(t,r,s):this.wNAFUnsafe(o,this.getPrecomputes(o,t,n),r,s)}createCache(t,r){Er(r,this.bits),_r.set(t,r),pn.delete(t)}hasCache(t){return mn(t)!==1}};function Sr(e,t,r,n){let s=t,o=e.ZERO,f=e.ZERO;for(;r>re||n>re;)r&Xt&&(o=o.add(s)),n&Xt&&(f=f.add(s)),s=s.double(),r>>=Xt,n>>=Xt;return{p1:o,p2:f}}function vr(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return hn(t),t}else return it(e,{isLE:r})}function Ne(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let i of["p","n","h"]){let a=t[i];if(!(typeof a=="bigint"&&a>re))throw new Error(`CURVE.${i} must be positive bigint`)}let s=vr(t.p,r.Fp,n),o=vr(t.n,r.Fn,n),c=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let i of c)if(!s.isValid(t[i]))throw new Error(`CURVE.${i} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:s,Fn:o}}function Ct(e,t){return function(n){let s=e(n);return{secretKey:s,publicKey:t(s)}}}var Zt=BigInt(0),et=BigInt(1),gn=BigInt(2),eo=BigInt(8);function no(e,t,r,n){let s=e.sqr(r),o=e.sqr(n),f=e.add(e.mul(t.a,s),o),c=e.add(e.ONE,e.mul(t.d,e.mul(s,o)));return e.eql(f,c)}function Yt(e,t={}){let r=Ne("edwards",e,t,t.FpFnLE),{Fp:n,Fn:s}=r,o=r.CURVE,{h:f}=o;gt(t,{},{uvRatio:"function"});let c=gn<<BigInt(s.BYTES*8)-et,i=y=>n.create(y),a=t.uvRatio||((y,g)=>{try{return{isValid:!0,value:n.sqrt(n.div(y,g))}}catch{return{isValid:!1,value:Zt}}});if(!no(n,o,o.Gx,o.Gy))throw new Error("bad curve params: generator point");function l(y,g,S=!1){let w=S?et:Zt;return kt("coordinate "+y,g,w,c),g}function h(y){if(!(y instanceof p))throw new Error("EdwardsPoint expected")}let d=ee((y,g)=>{let{X:S,Y:w,Z:O}=y,D=y.is0();g==null&&(g=D?eo:n.inv(O));let C=i(S*g),k=i(w*g),B=n.mul(O,g);if(D)return{x:Zt,y:et};if(B!==et)throw new Error("invZ was invalid");return{x:C,y:k}}),u=ee(y=>{let{a:g,d:S}=o;if(y.is0())throw new Error("bad point: ZERO");let{X:w,Y:O,Z:D,T:C}=y,k=i(w*w),B=i(O*O),v=i(D*D),N=i(v*v),Z=i(k*g),H=i(v*i(Z+B)),m=i(N+i(S*i(k*B)));if(H!==m)throw new Error("bad point: equation left != right (1)");let b=i(w*O),x=i(D*C);if(b!==x)throw new Error("bad point: equation left != right (2)");return!0});class p{static BASE=new p(o.Gx,o.Gy,et,i(o.Gx*o.Gy));static ZERO=new p(Zt,et,et,Zt);static Fp=n;static Fn=s;X;Y;Z;T;constructor(g,S,w,O){this.X=l("x",g),this.Y=l("y",S),this.Z=l("z",w,!0),this.T=l("t",O),Object.freeze(this)}static CURVE(){return o}static fromAffine(g){if(g instanceof p)throw new Error("extended point not allowed");let{x:S,y:w}=g||{};return l("x",S),l("y",w),new p(S,w,et,i(S*w))}static fromBytes(g,S=!1){let w=n.BYTES,{a:O,d:D}=o;g=Gt(L(g,w,"point")),Et(S,"zip215");let C=Gt(g),k=g[w-1];C[w-1]=k&-129;let B=dt(C),v=S?c:n.ORDER;kt("point.y",B,Zt,v);let N=i(B*B),Z=i(N-et),H=i(D*N-O),{isValid:m,value:b}=a(Z,H);if(!m)throw new Error("bad point: invalid y coordinate");let x=(b&et)===et,E=(k&128)!==0;if(!S&&b===Zt&&E)throw new Error("bad point: x=0 and x_0=1");return E!==x&&(b=i(-b)),p.fromAffine({x:b,y:B})}static fromHex(g,S=!1){return p.fromBytes(ot(g),S)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(g=8,S=!0){return _.createCache(this,g),S||this.multiply(gn),this}assertValidity(){u(this)}equals(g){h(g);let{X:S,Y:w,Z:O}=this,{X:D,Y:C,Z:k}=g,B=i(S*k),v=i(D*O),N=i(w*k),Z=i(C*O);return B===v&&N===Z}is0(){return this.equals(p.ZERO)}negate(){return new p(i(-this.X),this.Y,this.Z,i(-this.T))}double(){let{a:g}=o,{X:S,Y:w,Z:O}=this,D=i(S*S),C=i(w*w),k=i(gn*i(O*O)),B=i(g*D),v=S+w,N=i(i(v*v)-D-C),Z=B+C,H=Z-k,m=B-C,b=i(N*H),x=i(Z*m),E=i(N*m),R=i(H*Z);return new p(b,x,R,E)}add(g){h(g);let{a:S,d:w}=o,{X:O,Y:D,Z:C,T:k}=this,{X:B,Y:v,Z:N,T:Z}=g,H=i(O*B),m=i(D*v),b=i(k*w*Z),x=i(C*N),E=i((O+D)*(B+v)-H-m),R=x-b,I=x+b,T=i(m-S*H),A=i(E*R),U=i(I*T),q=i(E*T),j=i(R*I);return new p(A,U,j,q)}subtract(g){return this.add(g.negate())}multiply(g){if(!s.isValidNot0(g))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:S,f:w}=_.cached(this,g,O=>jt(p,O));return jt(p,[S,w])[0]}multiplyUnsafe(g,S=p.ZERO){if(!s.isValid(g))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return g===Zt?p.ZERO:this.is0()||g===et?this:_.unsafe(this,g,w=>jt(p,w),S)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}isTorsionFree(){return _.unsafe(this,o.n).is0()}toAffine(g){return d(this,g)}clearCofactor(){return f===et?this:this.multiplyUnsafe(f)}toBytes(){let{x:g,y:S}=this.toAffine(),w=n.toBytes(S);return w[w.length-1]|=g&et?128:0,w}toHex(){return ht(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let _=new se(p,s.BITS);return p.BASE.precompute(8),p}var oe=class{static BASE;static ZERO;static Fp;static Fn;ep;constructor(t){this.ep=t}static fromBytes(t){dn()}static fromHex(t){dn()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toHex(){return ht(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,r){return this.init(this.ep.precompute(t,r))}};function Wt(e,t,r={}){if(typeof t!="function")throw new Error('"hash" function param is required');gt(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:n}=r,{BASE:s,Fp:o,Fn:f}=e,c=r.randomBytes||xt,i=r.adjustScalarBytes||(B=>B),a=r.domain||((B,v,N)=>{if(Et(N,"phflag"),v.length||N)throw new Error("Contexts/pre-hash are not supported");return B});function l(B){return f.create(dt(B))}function h(B){let v=w.secretKey;L(B,w.secretKey,"secretKey");let N=L(t(B),2*v,"hashedSecretKey"),Z=i(N.slice(0,v)),H=N.slice(v,2*v),m=l(Z);return{head:Z,prefix:H,scalar:m}}function d(B){let{head:v,prefix:N,scalar:Z}=h(B),H=s.multiply(Z),m=H.toBytes();return{head:v,prefix:N,scalar:Z,point:H,pointBytes:m}}function u(B){return d(B).pointBytes}function p(B=Uint8Array.of(),...v){let N=Y(...v);return l(t(a(N,L(B,void 0,"context"),!!n)))}function _(B,v,N={}){B=L(B,void 0,"message"),n&&(B=n(B));let{prefix:Z,scalar:H,pointBytes:m}=d(v),b=p(N.context,Z,B),x=s.multiply(b).toBytes(),E=p(N.context,x,m,B),R=f.create(b+E*H);if(!f.isValid(R))throw new Error("sign failed: invalid s");let I=Y(x,f.toBytes(R));return L(I,w.signature,"result")}let y={zip215:!0};function g(B,v,N,Z=y){let{context:H,zip215:m}=Z,b=w.signature;B=L(B,b,"signature"),v=L(v,void 0,"message"),N=L(N,w.publicKey,"publicKey"),m!==void 0&&Et(m,"zip215"),n&&(v=n(v));let x=b/2,E=B.subarray(0,x),R=dt(B.subarray(x,b)),I,T,A;try{I=e.fromBytes(N,m),T=e.fromBytes(E,m),A=s.multiplyUnsafe(R)}catch{return!1}if(!m&&I.isSmallOrder())return!1;let U=p(H,T.toBytes(),I.toBytes(),v);return T.add(I.multiplyUnsafe(U)).subtract(A).clearCofactor().is0()}let S=o.BYTES,w={secretKey:S,publicKey:S,signature:2*S,seed:S};function O(B=c(w.seed)){return L(B,w.seed,"seed")}function D(B){return Vt(B)&&B.length===f.BYTES}function C(B,v){try{return!!e.fromBytes(B,v)}catch{return!1}}let k={getExtendedPublicKey:d,randomSecretKey:O,isValidSecretKey:D,isValidPublicKey:C,toMontgomery(B){let{y:v}=e.fromBytes(B),N=w.publicKey,Z=N===32;if(!Z&&N!==57)throw new Error("only defined for 25519 and 448");let H=Z?o.div(et+v,et-v):o.div(v-et,v+et);return o.toBytes(H)},toMontgomerySecret(B){let v=w.secretKey;L(B,v);let N=t(B.subarray(0,v));return i(N).subarray(0,v)}};return Object.freeze({keygen:Ct(O,u),getPublicKey:u,sign:_,verify:g,utils:k,Point:e,lengths:w})}var ye=BigInt(0),fe=BigInt(1),ke=BigInt(2);function ro(e){return gt(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}function Ce(e){let t=ro(e),{P:r,type:n,adjustScalarBytes:s,powPminus2:o,randomBytes:f}=t,c=n==="x25519";if(!c&&n!=="x448")throw new Error("invalid type");let i=f||xt,a=c?255:448,l=c?32:56,h=BigInt(c?9:5),d=BigInt(c?121665:39081),u=c?ke**BigInt(254):ke**BigInt(447),p=c?BigInt(8)*ke**BigInt(251)-fe:BigInt(4)*ke**BigInt(445)-fe,_=u+p+fe,y=b=>V(b,r),g=S(h);function S(b){return pe(y(b),l)}function w(b){let x=Gt(L(b,l,"uCoordinate"));return c&&(x[31]&=127),y(dt(x))}function O(b){return dt(s(Gt(L(b,l,"scalar"))))}function D(b,x){let E=N(w(x),O(b));if(E===ye)throw new Error("invalid private or public key received");return S(E)}function C(b){return D(b,g)}let k=C,B=D;function v(b,x,E){let R=y(b*(x-E));return x=y(x-R),E=y(E+R),{x_2:x,x_3:E}}function N(b,x){kt("u",b,ye,r),kt("scalar",x,u,_);let E=x,R=b,I=fe,T=ye,A=b,U=fe,q=ye;for(let G=BigInt(a-1);G>=ye;G--){let M=E>>G&fe;q^=M,{x_2:I,x_3:A}=v(q,I,A),{x_2:T,x_3:U}=v(q,T,U),q=M;let P=I+T,W=y(P*P),ct=I-T,X=y(ct*ct),z=W-X,Ft=A+U,Ie=A-U,ue=y(Ie*P),Mn=y(Ft*ct),Vn=ue+Mn,Gn=ue-Mn;A=y(Vn*Vn),U=y(R*y(Gn*Gn)),I=y(W*X),T=y(z*(W+y(d*z)))}({x_2:I,x_3:A}=v(q,I,A)),{x_2:T,x_3:U}=v(q,T,U);let j=o(T);return y(I*j)}let Z={secretKey:l,publicKey:l,seed:l},H=(b=i(l))=>(L(b,Z.seed,"seed"),b),m={randomSecretKey:H};return Object.freeze({keygen:Ct(H,k),getSharedSecret:B,getPublicKey:k,scalarMult:D,scalarMultBase:C,utils:m,GuBytes:g.slice(),lengths:Z})}var so=BigInt(0),we=BigInt(1),Ir=BigInt(2),oo=BigInt(3),fo=BigInt(5),io=BigInt(8),ie=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Rr={p:ie,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:io,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Tr(e){let t=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),o=ie,c=e*e%o*e%o,i=K(c,Ir,o)*c%o,a=K(i,we,o)*e%o,l=K(a,fo,o)*a%o,h=K(l,t,o)*l%o,d=K(h,r,o)*h%o,u=K(d,n,o)*d%o,p=K(u,s,o)*u%o,_=K(p,s,o)*u%o,y=K(_,t,o)*l%o;return{pow_p_5_8:K(y,Ir,o)*e%o,b2:c}}function Lr(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var yn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Hr(e,t){let r=ie,n=V(t*t*t,r),s=V(n*n*t,r),o=Tr(e*s).pow_p_5_8,f=V(e*n*o,r),c=V(t*f*f,r),i=f,a=V(f*yn,r),l=c===e,h=c===V(-e,r),d=c===V(-e*yn,r);return l&&(f=i),(h||d)&&(f=a),ut(f,r)&&(f=V(-f,r)),{isValid:l||h,value:f}}var $t=Yt(Rr,{uvRatio:Hr}),zt=$t.Fp,co=$t.Fn;function Ur(e,t,r){if(t.length>255)throw new Error("Context is too big");return Y(Nt("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}function Bn(e){return Wt($t,Dt,Object.assign({adjustScalarBytes:Lr},e))}var Dr=Bn({}),qr=Bn({domain:Ur}),Nr=Bn({domain:Ur,prehash:Dt}),kr=(()=>{let e=ie;return Ce({P:e,type:"x25519",powPminus2:t=>{let{pow_p_5_8:r,b2:n}=Tr(t);return V(K(r,oo,e)*n,e)},adjustScalarBytes:Lr})})();var Ar=yn;var ao=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");var Or=e=>Hr(we,e),uo=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),lo=e=>zt.create(dt(e)&uo);var wn=class e extends oe{static BASE=new e($t.BASE);static ZERO=new e($t.ZERO);static Fp=zt;static Fn=co;constructor(t){super(t)}static fromAffine(t){return new e($t.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("RistrettoPoint expected")}init(t){return new e(t)}static fromBytes(t){L(t,32);let{a:r,d:n}=Rr,s=ie,o=O=>zt.create(O),f=lo(t);if(!De(zt.toBytes(f),t)||ut(f,s))throw new Error("invalid ristretto255 encoding 1");let c=o(f*f),i=o(we+r*c),a=o(we-r*c),l=o(i*i),h=o(a*a),d=o(r*n*l-h),{isValid:u,value:p}=Or(o(d*h)),_=o(p*a),y=o(p*_*d),g=o((f+f)*_);ut(g,s)&&(g=o(-g));let S=o(i*y),w=o(g*S);if(!u||ut(w,s)||S===so)throw new Error("invalid ristretto255 encoding 2");return new e(new $t(g,S,we,w))}static fromHex(t){return e.fromBytes(ot(t))}toBytes(){let{X:t,Y:r,Z:n,T:s}=this.ep,o=ie,f=y=>zt.create(y),c=f(f(n+r)*f(n-r)),i=f(t*r),a=f(i*i),{value:l}=Or(f(c*a)),h=f(l*c),d=f(l*i),u=f(h*d*s),p;if(ut(s*u,o)){let y=f(r*Ar),g=f(t*Ar);t=y,r=g,p=f(h*ao)}else p=d;ut(t*u,o)&&(r=f(-r));let _=f((n-r)*p);return ut(_,o)&&(_=f(-_)),zt.toBytes(_)}equals(t){this.assertSame(t);let{X:r,Y:n}=this.ep,{X:s,Y:o}=t.ep,f=a=>zt.create(a),c=f(r*o)===f(n*s),i=f(n*o)===f(r*s);return c||i}is0(){return this.equals(e.ZERO)}},Cr={Point:wn};var ho=BigInt(0),Be=BigInt(1),bo=BigInt(2),xo=BigInt(7),po=BigInt(256),mo=BigInt(113),Mr=[],Vr=[],Gr=[];for(let e=0,t=Be,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Mr.push(2*(5*n+r)),Vr.push((e+1)*(e+2)/2%64);let s=ho;for(let o=0;o<7;o++)t=(t<<Be^(t>>xo)*mo)%po,t&bo&&(s^=Be<<(Be<<BigInt(o))-Be);Gr.push(s)}var Pr=Re(Gr,!0),go=Pr[0],yo=Pr[1],Zr=(e,t,r)=>r>32?Jn(e,t,r):Qn(e,t,r),Kr=(e,t,r)=>r>32?tr(e,t,r):Fn(e,t,r);function wo(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let f=0;f<10;f++)r[f]=e[f]^e[f+10]^e[f+20]^e[f+30]^e[f+40];for(let f=0;f<10;f+=2){let c=(f+8)%10,i=(f+2)%10,a=r[i],l=r[i+1],h=Zr(a,l,1)^r[c],d=Kr(a,l,1)^r[c+1];for(let u=0;u<50;u+=10)e[f+u]^=h,e[f+u+1]^=d}let s=e[2],o=e[3];for(let f=0;f<24;f++){let c=Vr[f],i=Zr(s,o,c),a=Kr(s,o,c),l=Mr[f];s=e[l],o=e[l+1],e[l]=i,e[l+1]=a}for(let f=0;f<50;f+=10){for(let c=0;c<10;c++)r[c]=e[f+c];for(let c=0;c<10;c++)e[f+c]^=~r[(c+2)%10]&r[(c+4)%10]}e[0]^=go[n],e[1]^=yo[n]}Q(r)}var vn=class e{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor(t,r,n,s=!1,o=24){if(this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=o,at(n,"outputLen"),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=jn(this.state)}clone(){return this._cloneInto()}keccak(){$e(this.state32),wo(this.state32,this.rounds),$e(this.state32),this.posOut=0,this.pos=0}update(t){lt(this),L(t);let{blockLen:r,state:n}=this,s=t.length;for(let o=0;o<s;){let f=Math.min(r-this.pos,s-o);for(let c=0;c<f;c++)n[this.pos++]^=t[o++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:n,blockLen:s}=this;t[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){lt(this,!1),L(t),this.finish();let r=this.state,{blockLen:n}=this;for(let s=0,o=t.length;s<o;){this.posOut>=n&&this.keccak();let f=Math.min(n-this.posOut,o-s);t.set(r.subarray(this.posOut,this.posOut+f),s),this.posOut+=f,s+=f}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return at(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Jt(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Q(this.state)}_cloneInto(t){let{blockLen:r,suffix:n,outputLen:s,rounds:o,enableXOF:f}=this;return t||=new e(r,n,s,f,o),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=n,t.outputLen=s,t.enableXOF=f,t.destroyed=this.destroyed,t}};var Bo=(e,t,r,n={})=>bt((s={})=>new vn(t,e,s.dkLen===void 0?r:s.dkLen,!0),n);var En=Bo(31,136,32,te(12));var ae=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),_e={p:ae,n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")};var vo=bt(()=>En.create({dkLen:114})),Eo=bt(()=>En.create({dkLen:64})),Ee=BigInt(1),Ze=BigInt(2),Xr=BigInt(3),_o=BigInt(4),So=BigInt(11),Io=BigInt(22),jr=BigInt(44),Ao=BigInt(88),Oo=BigInt(223);function Qr(e){let t=ae,r=e*e*e%t,n=r*r*e%t,s=K(n,Xr,t)*n%t,o=K(s,Xr,t)*n%t,f=K(o,Ze,t)*r%t,c=K(f,So,t)*f%t,i=K(c,Io,t)*c%t,a=K(i,jr,t)*i%t,l=K(a,Ao,t)*a%t,h=K(l,jr,t)*i%t,d=K(h,Ze,t)*r%t,u=K(d,Ee,t)*e%t;return K(u,Oo,t)*d%t}function Fr(e){return e[0]&=252,e[55]|=128,e[56]=0,e}function Jr(e,t){let r=ae,n=V(e*e*t,r),s=V(n*e,r),o=V(s*n*t,r),f=Qr(o),c=V(s*f,r),i=V(c*c,r);return{isValid:V(i*t,r)===e,value:c}}var Ro=it(ae,{BITS:456,isLE:!0}),To=it(_e.n,{BITS:456,isLE:!0}),ce=it(ae,{BITS:448,isLE:!0}),_n=it(_e.n,{BITS:448,isLE:!0});function Lo(e,t,r){if(t.length>255)throw new Error("context must be smaller than 255, got: "+t.length);return Y(Nt("SigEd448"),new Uint8Array([r?1:0,t.length]),t,e)}var ve=Yt(_e,{Fp:Ro,Fn:To,uvRatio:Jr});function ts(e){return Wt(ve,vo,Object.assign({adjustScalarBytes:Fr,domain:Lo},e))}var es=ts({}),ns=ts({prehash:Eo});var rs=(()=>{let e=ae;return Ce({P:e,type:"x448",powPminus2:t=>{let r=Qr(t),n=K(r,Ze,e);return V(n*t,e)},adjustScalarBytes:Fr})})();var Yr=BigInt("39082");var Wr=BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),zr=BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),$r=e=>Jr(Ee,e);var Sn=class e extends oe{static BASE=new e(ve.BASE).multiplyUnsafe(Ze);static ZERO=new e(ve.ZERO);static Fp=ce;static Fn=_n;constructor(t){super(t)}static fromAffine(t){return new e(ve.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("DecafPoint expected")}init(t){return new e(t)}static fromBytes(t){L(t,56);let{d:r,p:n}=_e,s=y=>ce.create(y),o=ce.fromBytes(t);if(!De(_n.toBytes(o),t)||ut(o,n))throw new Error("invalid decaf448 encoding 1");let f=s(o*o),c=s(Ee+f),i=s(c*c),a=s(i-_o*r*f),{isValid:l,value:h}=$r(s(a*i)),d=s((o+o)*h*c*Wr);ut(d,n)&&(d=s(-d));let u=s(d*h*a*zr),p=s((Ee-f)*h*c),_=s(u*p);if(!l)throw new Error("invalid decaf448 encoding 2");return new e(new ve(u,p,Ee,_))}static fromHex(t){return e.fromBytes(ot(t))}toBytes(){let{X:t,Z:r,T:n}=this.ep,s=_e.p,o=d=>ce.create(d),f=o(o(t+n)*o(t-n)),c=o(t*t),{value:i}=$r(o(f*Yr*c)),a=o(i*f*Wr);ut(a,s)&&(a=o(-a));let l=o(zr*a*r-n),h=o(Yr*i*t*l);return ut(h,s)&&(h=o(-h)),_n.toBytes(h)}equals(t){this.assertSame(t);let{X:r,Y:n}=this.ep,{X:s,Y:o}=t.ep;return ce.create(r*o)===ce.create(n*s)}is0(){return this.equals(e.ZERO)}},ss={Point:Sn};var $=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);function _t(e,t,r,n,s){return e=e+t+s|0,n=rt(n^e,16),r=r+n|0,t=rt(t^r,12),{a:e,b:t,c:r,d:n}}function St(e,t,r,n,s){return e=e+t+s|0,n=rt(n^e,8),r=r+n|0,t=rt(t^r,7),{a:e,b:t,c:r,d:n}}var os=new Uint32Array(8),In=class{finished=!1;length=0;pos=0;destroyed=!1;buffer;view;salt;blockLen;outputLen;lengthFlag;counterLen;constants;constructor(t,r,n,s,o,f,c={}){let{salt:i}=c;if(this.blockLen=t,this.outputLen=r,this.lengthFlag=n,this.counterLen=s,this.buffer=new Uint8Array(t),this.view=vt(this.buffer),i!==void 0){let a=i;L(a,4*o,"salt");let l=this.salt=new Uint32Array(o),h=vt(a);this.constants=f.slice();for(let d=0,u=0;d<l.length;d++,u+=4)l[d]=h.getUint32(u,!1),this.constants[d]^=l[d]}else this.salt=os,this.constants=f}update(t){lt(this),L(t);let{view:r,buffer:n,blockLen:s}=this,o=t.length,f;for(let c=0;c<o;){let i=Math.min(s-this.pos,o-c);if(i===s){for(f||(f=vt(t));s<=o-c;c+=s)this.length+=s,this.compress(f,c);continue}n.set(t.subarray(c,c+i),this.pos),this.pos+=i,c+=i,this.pos===s&&(this.length+=s,this.compress(r,0,!0),this.pos=0)}return this}destroy(){this.destroyed=!0,this.salt!==os&&Q(this.salt,this.constants)}_cloneInto(t){t||=new this.constructor,t.set(...this.get());let{buffer:r,length:n,finished:s,destroyed:o,constants:f,salt:c,pos:i}=this;return t.buffer.set(r),t.constants=f.slice(),t.destroyed=o,t.finished=s,t.length=n,t.pos=i,t.salt=c.slice(),t}clone(){return this._cloneInto()}digestInto(t){lt(this),Jt(t,this),this.finished=!0;let{buffer:r,blockLen:n,counterLen:s,lengthFlag:o,view:f}=this;Q(r.subarray(this.pos));let c=BigInt((this.length+this.pos)*8),i=n-s-1;r[this.pos]|=128,this.length+=this.pos,this.pos>i&&(this.compress(f,0),Q(r),this.pos=0),r[i]|=o,f.setBigUint64(n-8,c,!1),this.compress(f,0,this.pos!==0),Q(r);let a=vt(t),l=this.get();for(let h=0;h<this.outputLen/4;++h)a.setUint32(h*4,l[h])}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}},Ho=Uint32Array.from([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731,3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113]),An=Ho.slice(0,16),Uo=pt.slice();function Do(){let e=[];for(let t=0,r=0;t<14;t++,r+=16)for(let n=1;n<16;n+=2)e.push(An[$[r+n]]),e.push(An[$[r+n-1]]);return new Uint32Array(e)}var st=Do(),nt=new Uint32Array(16),On=class extends In{v0;v1;v2;v3;v4;v5;v6;v7;constructor(t,r,n,s={}){super(64,t,n,8,4,An,s),this.v0=r[0]|0,this.v1=r[1]|0,this.v2=r[2]|0,this.v3=r[3]|0,this.v4=r[4]|0,this.v5=r[5]|0,this.v6=r[6]|0,this.v7=r[7]|0}get(){let{v0:t,v1:r,v2:n,v3:s,v4:o,v5:f,v6:c,v7:i}=this;return[t,r,n,s,o,f,c,i]}set(t,r,n,s,o,f,c,i){this.v0=t|0,this.v1=r|0,this.v2=n|0,this.v3=s|0,this.v4=o|0,this.v5=f|0,this.v6=c|0,this.v7=i|0}destroy(){super.destroy(),this.set(0,0,0,0,0,0,0,0)}compress(t,r,n=!0){for(let C=0;C<16;C++,r+=4)nt[C]=t.getUint32(r,!1);let s=this.v0|0,o=this.v1|0,f=this.v2|0,c=this.v3|0,i=this.v4|0,a=this.v5|0,l=this.v6|0,h=this.v7|0,d=this.constants[0]|0,u=this.constants[1]|0,p=this.constants[2]|0,_=this.constants[3]|0,{h:y,l:g}=Qe(BigInt(n?this.length*8:0)),S=(this.constants[4]^g)>>>0,w=(this.constants[5]^g)>>>0,O=(this.constants[6]^y)>>>0,D=(this.constants[7]^y)>>>0;for(let C=0,k=0,B=0;C<14;C++)({a:s,b:i,c:d,d:S}=_t(s,i,d,S,nt[$[k++]]^st[B++])),{a:s,b:i,c:d,d:S}=St(s,i,d,S,nt[$[k++]]^st[B++]),{a:o,b:a,c:u,d:w}=_t(o,a,u,w,nt[$[k++]]^st[B++]),{a:o,b:a,c:u,d:w}=St(o,a,u,w,nt[$[k++]]^st[B++]),{a:f,b:l,c:p,d:O}=_t(f,l,p,O,nt[$[k++]]^st[B++]),{a:f,b:l,c:p,d:O}=St(f,l,p,O,nt[$[k++]]^st[B++]),{a:c,b:h,c:_,d:D}=_t(c,h,_,D,nt[$[k++]]^st[B++]),{a:c,b:h,c:_,d:D}=St(c,h,_,D,nt[$[k++]]^st[B++]),{a:s,b:a,c:p,d:D}=_t(s,a,p,D,nt[$[k++]]^st[B++]),{a:s,b:a,c:p,d:D}=St(s,a,p,D,nt[$[k++]]^st[B++]),{a:o,b:l,c:_,d:S}=_t(o,l,_,S,nt[$[k++]]^st[B++]),{a:o,b:l,c:_,d:S}=St(o,l,_,S,nt[$[k++]]^st[B++]),{a:f,b:h,c:d,d:w}=_t(f,h,d,w,nt[$[k++]]^st[B++]),{a:f,b:h,c:d,d:w}=St(f,h,d,w,nt[$[k++]]^st[B++]),{a:c,b:i,c:u,d:O}=_t(c,i,u,O,nt[$[k++]]^st[B++]),{a:c,b:i,c:u,d:O}=St(c,i,u,O,nt[$[k++]]^st[B++]);this.v0=(this.v0^s^d^this.salt[0])>>>0,this.v1=(this.v1^o^u^this.salt[1])>>>0,this.v2=(this.v2^f^p^this.salt[2])>>>0,this.v3=(this.v3^c^_^this.salt[3])>>>0,this.v4=(this.v4^i^S^this.salt[0])>>>0,this.v5=(this.v5^a^w^this.salt[1])>>>0,this.v6=(this.v6^l^O^this.salt[2])>>>0,this.v7=(this.v7^h^D^this.salt[3])>>>0,Q(nt)}};var Rn=class extends On{constructor(t={}){super(32,Uo,1,t)}};var fs=bt(e=>new Rn(e));var Ke=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){if(Ae(t),L(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,s=new Uint8Array(n);s.set(r.length>n?t.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),Q(s)}update(t){return lt(this),this.iHash.update(t),this}digestInto(t){lt(this),L(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});let{oHash:r,iHash:n,finished:s,destroyed:o,blockLen:f,outputLen:c}=this;return t=t,t.finished=s,t.destroyed=o,t.blockLen=f,t.outputLen=c,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Tn=(e,t,r)=>new Ke(e,t).update(r).digest();Tn.create=(e,t)=>new Ke(e,t);var is=(e,t)=>(e+(e>=0?t:-t)/cs)/t;function qo(e,t,r){let[[n,s],[o,f]]=t,c=is(f*e,r),i=is(-s*e,r),a=e-c*n-i*o,l=-c*s-i*f,h=a<It,d=l<It;h&&(a=-a),d&&(l=-l);let u=me(Math.ceil(an(r)/2))+de;if(a<It||a>=u||l<It||l>=u)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:h,k1:a,k2neg:d,k2:l}}function Hn(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function Ln(e,t){let r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return Et(r.lowS,"lowS"),Et(r.prehash,"prehash"),r.format!==void 0&&Hn(r.format),r}var Un=class extends Error{constructor(t=""){super(t)}},Kt={Err:Un,_tlv:{encode:(e,t)=>{let{Err:r}=Kt;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let n=t.length/2,s=xe(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");let o=n>127?xe(s.length/2|128):"";return xe(e)+o+s+t},decode(e,t){let{Err:r}=Kt,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let s=t[n++],o=!!(s&128),f=0;if(!o)f=s;else{let i=s&127;if(!i)throw new r("tlv.decode(long): indefinite length not supported");if(i>4)throw new r("tlv.decode(long): byte length is too big");let a=t.subarray(n,n+i);if(a.length!==i)throw new r("tlv.decode: length bytes not complete");if(a[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let l of a)f=f<<8|l;if(n+=i,f<128)throw new r("tlv.decode(long): not minimal encoding")}let c=t.subarray(n,n+f);if(c.length!==f)throw new r("tlv.decode: wrong value length");return{v:c,l:t.subarray(n+f)}}},_int:{encode(e){let{Err:t}=Kt;if(e<It)throw new t("integer: negative integers are not allowed");let r=xe(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=Kt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return qt(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=Kt,s=L(e,void 0,"signature"),{v:o,l:f}=n.decode(48,s);if(f.length)throw new t("invalid signature: left bytes after parsing");let{v:c,l:i}=n.decode(2,o),{v:a,l}=n.decode(2,i);if(l.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(c),s:r.decode(a)}},hexFromSig(e){let{_tlv:t,_int:r}=Kt,n=t.encode(2,r.encode(e.r)),s=t.encode(2,r.encode(e.s)),o=n+s;return t.encode(48,o)}},It=BigInt(0),de=BigInt(1),cs=BigInt(2),Me=BigInt(3),No=BigInt(4);function yt(e,t={}){let r=Ne("weierstrass",e,t),{Fp:n,Fn:s}=r,o=r.CURVE,{h:f,n:c}=o;gt(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});let{endo:i}=t;if(i&&(!n.is0(o.a)||typeof i.beta!="bigint"||!Array.isArray(i.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let a=ds(n,s);function l(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function h(H,m,b){let{x,y:E}=m.toAffine(),R=n.toBytes(x);if(Et(b,"isCompressed"),b){l();let I=!n.isOdd(E);return Y(as(I),R)}else return Y(Uint8Array.of(4),R,n.toBytes(E))}function d(H){L(H,void 0,"Point");let{publicKey:m,publicKeyUncompressed:b}=a,x=H.length,E=H[0],R=H.subarray(1);if(x===m&&(E===2||E===3)){let I=n.fromBytes(R);if(!n.isValid(I))throw new Error("bad point: is not on curve, wrong x");let T=_(I),A;try{A=n.sqrt(T)}catch(j){let G=j instanceof Error?": "+j.message:"";throw new Error("bad point: is not on curve, sqrt error"+G)}l();let U=n.isOdd(A);return(E&1)===1!==U&&(A=n.neg(A)),{x:I,y:A}}else if(x===b&&E===4){let I=n.BYTES,T=n.fromBytes(R.subarray(0,I)),A=n.fromBytes(R.subarray(I,I*2));if(!y(T,A))throw new Error("bad point: is not on curve");return{x:T,y:A}}else throw new Error(`bad point: got length ${x}, expected compressed=${m} or uncompressed=${b}`)}let u=t.toBytes||h,p=t.fromBytes||d;function _(H){let m=n.sqr(H),b=n.mul(m,H);return n.add(n.add(b,n.mul(H,o.a)),o.b)}function y(H,m){let b=n.sqr(m),x=_(H);return n.eql(b,x)}if(!y(o.Gx,o.Gy))throw new Error("bad curve params: generator point");let g=n.mul(n.pow(o.a,Me),No),S=n.mul(n.sqr(o.b),BigInt(27));if(n.is0(n.add(g,S)))throw new Error("bad curve params: a or b");function w(H,m,b=!1){if(!n.isValid(m)||b&&n.is0(m))throw new Error(`bad point coordinate ${H}`);return m}function O(H){if(!(H instanceof v))throw new Error("Weierstrass Point expected")}function D(H){if(!i||!i.basises)throw new Error("no endo");return qo(H,i.basises,s.ORDER)}let C=ee((H,m)=>{let{X:b,Y:x,Z:E}=H;if(n.eql(E,n.ONE))return{x:b,y:x};let R=H.is0();m==null&&(m=R?n.ONE:n.inv(E));let I=n.mul(b,m),T=n.mul(x,m),A=n.mul(E,m);if(R)return{x:n.ZERO,y:n.ZERO};if(!n.eql(A,n.ONE))throw new Error("invZ was invalid");return{x:I,y:T}}),k=ee(H=>{if(H.is0()){if(t.allowInfinityPoint&&!n.is0(H.Y))return;throw new Error("bad point: ZERO")}let{x:m,y:b}=H.toAffine();if(!n.isValid(m)||!n.isValid(b))throw new Error("bad point: x or y not field elements");if(!y(m,b))throw new Error("bad point: equation left != right");if(!H.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function B(H,m,b,x,E){return b=new v(n.mul(b.X,H),b.Y,b.Z),m=ge(x,m),b=ge(E,b),m.add(b)}class v{static BASE=new v(o.Gx,o.Gy,n.ONE);static ZERO=new v(n.ZERO,n.ONE,n.ZERO);static Fp=n;static Fn=s;X;Y;Z;constructor(m,b,x){this.X=w("x",m),this.Y=w("y",b,!0),this.Z=w("z",x),Object.freeze(this)}static CURVE(){return o}static fromAffine(m){let{x:b,y:x}=m||{};if(!m||!n.isValid(b)||!n.isValid(x))throw new Error("invalid affine point");if(m instanceof v)throw new Error("projective point not allowed");return n.is0(b)&&n.is0(x)?v.ZERO:new v(b,x,n.ONE)}static fromBytes(m){let b=v.fromAffine(p(L(m,void 0,"point")));return b.assertValidity(),b}static fromHex(m){return v.fromBytes(ot(m))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(m=8,b=!0){return Z.createCache(this,m),b||this.multiply(Me),this}assertValidity(){k(this)}hasEvenY(){let{y:m}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(m)}equals(m){O(m);let{X:b,Y:x,Z:E}=this,{X:R,Y:I,Z:T}=m,A=n.eql(n.mul(b,T),n.mul(R,E)),U=n.eql(n.mul(x,T),n.mul(I,E));return A&&U}negate(){return new v(this.X,n.neg(this.Y),this.Z)}double(){let{a:m,b}=o,x=n.mul(b,Me),{X:E,Y:R,Z:I}=this,T=n.ZERO,A=n.ZERO,U=n.ZERO,q=n.mul(E,E),j=n.mul(R,R),G=n.mul(I,I),M=n.mul(E,R);return M=n.add(M,M),U=n.mul(E,I),U=n.add(U,U),T=n.mul(m,U),A=n.mul(x,G),A=n.add(T,A),T=n.sub(j,A),A=n.add(j,A),A=n.mul(T,A),T=n.mul(M,T),U=n.mul(x,U),G=n.mul(m,G),M=n.sub(q,G),M=n.mul(m,M),M=n.add(M,U),U=n.add(q,q),q=n.add(U,q),q=n.add(q,G),q=n.mul(q,M),A=n.add(A,q),G=n.mul(R,I),G=n.add(G,G),q=n.mul(G,M),T=n.sub(T,q),U=n.mul(G,j),U=n.add(U,U),U=n.add(U,U),new v(T,A,U)}add(m){O(m);let{X:b,Y:x,Z:E}=this,{X:R,Y:I,Z:T}=m,A=n.ZERO,U=n.ZERO,q=n.ZERO,j=o.a,G=n.mul(o.b,Me),M=n.mul(b,R),P=n.mul(x,I),W=n.mul(E,T),ct=n.add(b,x),X=n.add(R,I);ct=n.mul(ct,X),X=n.add(M,P),ct=n.sub(ct,X),X=n.add(b,E);let z=n.add(R,T);return X=n.mul(X,z),z=n.add(M,W),X=n.sub(X,z),z=n.add(x,E),A=n.add(I,T),z=n.mul(z,A),A=n.add(P,W),z=n.sub(z,A),q=n.mul(j,X),A=n.mul(G,W),q=n.add(A,q),A=n.sub(P,q),q=n.add(P,q),U=n.mul(A,q),P=n.add(M,M),P=n.add(P,M),W=n.mul(j,W),X=n.mul(G,X),P=n.add(P,W),W=n.sub(M,W),W=n.mul(j,W),X=n.add(X,W),M=n.mul(P,X),U=n.add(U,M),M=n.mul(z,X),A=n.mul(ct,A),A=n.sub(A,M),M=n.mul(ct,P),q=n.mul(z,q),q=n.add(q,M),new v(A,U,q)}subtract(m){return this.add(m.negate())}is0(){return this.equals(v.ZERO)}multiply(m){let{endo:b}=t;if(!s.isValidNot0(m))throw new Error("invalid scalar: out of range");let x,E,R=I=>Z.cached(this,I,T=>jt(v,T));if(b){let{k1neg:I,k1:T,k2neg:A,k2:U}=D(m),{p:q,f:j}=R(T),{p:G,f:M}=R(U);E=j.add(M),x=B(b.beta,q,G,I,A)}else{let{p:I,f:T}=R(m);x=I,E=T}return jt(v,[x,E])[0]}multiplyUnsafe(m){let{endo:b}=t,x=this;if(!s.isValid(m))throw new Error("invalid scalar: out of range");if(m===It||x.is0())return v.ZERO;if(m===de)return x;if(Z.hasCache(this))return this.multiply(m);if(b){let{k1neg:E,k1:R,k2neg:I,k2:T}=D(m),{p1:A,p2:U}=Sr(v,x,R,T);return B(b.beta,A,U,E,I)}else return Z.unsafe(x,m)}toAffine(m){return C(this,m)}isTorsionFree(){let{isTorsionFree:m}=t;return f===de?!0:m?m(v,this):Z.unsafe(this,c).is0()}clearCofactor(){let{clearCofactor:m}=t;return f===de?this:m?m(v,this):this.multiplyUnsafe(f)}isSmallOrder(){return this.multiplyUnsafe(f).is0()}toBytes(m=!0){return Et(m,"isCompressed"),this.assertValidity(),u(v,this,m)}toHex(m=!0){return ht(this.toBytes(m))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let N=s.BITS,Z=new se(v,t.endo?Math.ceil(N/2):N);return v.BASE.precompute(8),v}function as(e){return Uint8Array.of(e?2:3)}function ds(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function ko(e,t={}){let{Fn:r}=e,n=t.randomBytes||xt,s=Object.assign(ds(e.Fp,r),{seed:bn(r.ORDER)});function o(u){try{let p=r.fromBytes(u);return r.isValidNot0(p)}catch{return!1}}function f(u,p){let{publicKey:_,publicKeyUncompressed:y}=s;try{let g=u.length;return p===!0&&g!==_||p===!1&&g!==y?!1:!!e.fromBytes(u)}catch{return!1}}function c(u=n(s.seed)){return qe(L(u,s.seed,"seed"),r.ORDER)}function i(u,p=!0){return e.BASE.multiply(r.fromBytes(u)).toBytes(p)}function a(u){let{secretKey:p,publicKey:_,publicKeyUncompressed:y}=s;if(!Vt(u)||"_lengths"in r&&r._lengths||p===_)return;let g=L(u,void 0,"key").length;return g===_||g===y}function l(u,p,_=!0){if(a(u)===!0)throw new Error("first arg must be private key");if(a(p)===!1)throw new Error("second arg must be public key");let y=r.fromBytes(u);return e.fromBytes(p).multiply(y).toBytes(_)}let h={isValidSecretKey:o,isValidPublicKey:f,randomSecretKey:c},d=Ct(c,i);return Object.freeze({getPublicKey:i,getSharedSecret:l,keygen:d,Point:e,utils:h,lengths:s})}function wt(e,t,r={}){Ae(t),gt(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),r=Object.assign({},r);let n=r.randomBytes||xt,s=r.hmac||((b,x)=>Tn(t,b,x)),{Fp:o,Fn:f}=e,{ORDER:c,BITS:i}=f,{keygen:a,getPublicKey:l,getSharedSecret:h,utils:d,lengths:u}=ko(e,r),p={prehash:!0,lowS:typeof r.lowS=="boolean"?r.lowS:!0,format:"compact",extraEntropy:!1},_=c*cs<o.ORDER;function y(b){let x=c>>de;return b>x}function g(b,x){if(!f.isValidNot0(x))throw new Error(`invalid signature ${b}: out of range 1..Point.Fn.ORDER`);return x}function S(){if(_)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function w(b,x){Hn(x);let E=u.signature,R=x==="compact"?E:x==="recovered"?E+1:void 0;return L(b,R)}class O{r;s;recovery;constructor(x,E,R){if(this.r=g("r",x),this.s=g("s",E),R!=null){if(S(),![0,1,2,3].includes(R))throw new Error("invalid recovery id");this.recovery=R}Object.freeze(this)}static fromBytes(x,E=p.format){w(x,E);let R;if(E==="der"){let{r:U,s:q}=Kt.toSig(L(x));return new O(U,q)}E==="recovered"&&(R=x[0],E="compact",x=x.subarray(1));let I=u.signature/2,T=x.subarray(0,I),A=x.subarray(I,I*2);return new O(f.fromBytes(T),f.fromBytes(A),R)}static fromHex(x,E){return this.fromBytes(ot(x),E)}assertRecovery(){let{recovery:x}=this;if(x==null)throw new Error("invalid recovery id: must be present");return x}addRecoveryBit(x){return new O(this.r,this.s,x)}recoverPublicKey(x){let{r:E,s:R}=this,I=this.assertRecovery(),T=I===2||I===3?E+c:E;if(!o.isValid(T))throw new Error("invalid recovery id: sig.r+curve.n != R.x");let A=o.toBytes(T),U=e.fromBytes(Y(as((I&1)===0),A)),q=f.inv(T),j=C(L(x,void 0,"msgHash")),G=f.create(-j*q),M=f.create(R*q),P=e.BASE.multiplyUnsafe(G).add(U.multiplyUnsafe(M));if(P.is0())throw new Error("invalid recovery: point at infinify");return P.assertValidity(),P}hasHighS(){return y(this.s)}toBytes(x=p.format){if(Hn(x),x==="der")return ot(Kt.hexFromSig(this));let{r:E,s:R}=this,I=f.toBytes(E),T=f.toBytes(R);return x==="recovered"?(S(),Y(Uint8Array.of(this.assertRecovery()),I,T)):Y(I,T)}toHex(x){return ht(this.toBytes(x))}}let D=r.bits2int||function(x){if(x.length>8192)throw new Error("input is too large");let E=qt(x),R=x.length*8-i;return R>0?E>>BigInt(R):E},C=r.bits2int_modN||function(x){return f.create(D(x))},k=me(i);function B(b){return kt("num < 2^"+i,b,It,k),f.toBytes(b)}function v(b,x){return L(b,void 0,"message"),x?L(t(b),void 0,"prehashed message"):b}function N(b,x,E){let{lowS:R,prehash:I,extraEntropy:T}=Ln(E,p);b=v(b,I);let A=C(b),U=f.fromBytes(x);if(!f.isValidNot0(U))throw new Error("invalid private key");let q=[B(U),B(A)];if(T!=null&&T!==!1){let P=T===!0?n(u.secretKey):T;q.push(L(P,void 0,"extraEntropy"))}let j=Y(...q),G=A;function M(P){let W=D(P);if(!f.isValidNot0(W))return;let ct=f.inv(W),X=e.BASE.multiply(W).toAffine(),z=f.create(X.x);if(z===It)return;let Ft=f.create(ct*f.create(G+z*U));if(Ft===It)return;let Ie=(X.x===z?0:2)|Number(X.y&de),ue=Ft;return R&&y(Ft)&&(ue=f.neg(Ft),Ie^=1),new O(z,ue,_?void 0:Ie)}return{seed:j,k2sig:M}}function Z(b,x,E={}){let{seed:R,k2sig:I}=N(b,x,E);return ar(t.outputLen,f.BYTES,s)(R,I).toBytes(E.format)}function H(b,x,E,R={}){let{lowS:I,prehash:T,format:A}=Ln(R,p);if(E=L(E,void 0,"publicKey"),x=v(x,T),!Vt(b)){let U=b instanceof O?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+U)}w(b,A);try{let U=O.fromBytes(b,A),q=e.fromBytes(E);if(I&&U.hasHighS())return!1;let{r:j,s:G}=U,M=C(x),P=f.inv(G),W=f.create(M*P),ct=f.create(j*P),X=e.BASE.multiplyUnsafe(W).add(q.multiplyUnsafe(ct));return X.is0()?!1:f.create(X.x)===j}catch{return!1}}function m(b,x,E={}){let{prehash:R}=Ln(E,p);return x=v(x,R),O.fromBytes(b,"recovered").recoverPublicKey(x).toBytes()}return Object.freeze({keygen:a,getPublicKey:l,getSharedSecret:h,utils:d,lengths:u,Point:e,sign:Z,verify:H,recoverPublicKey:m,Signature:O,hash:t})}var Co={p:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"),n:BigInt("0xe7db4ea6533afa906673b0101343b00a6682093ccc81082d0970e5ed6f72cb7"),h:BigInt(8),a:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000000"),d:BigInt("0x2a9318e74bfa2b48f5fd9207e6bd7fd4292d7f6d37579d2601065fd6d6343eb1"),Gx:BigInt("0x11dafe5d23e1218086a365b99fbf3d3be72f6afd7d1f72623e6b071492d1122b"),Gy:BigInt("0x1d523cf1ddab1a1793132e78c866c0c33e26ba5cc220fed7cc3f870e59d292aa")},us=Wt(Yt(Co),Dt),Zo={p:BigInt("0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001"),n:BigInt("0x30644e72e131a029b85045b68181585d59f76dc1c90770533b94bee1c9093788"),h:BigInt(8),a:BigInt("168700"),d:BigInt("168696"),Gx:BigInt("0x23343e3445b673d38bcba38f25645adb494b1255b1162bb40f41a59f4d4b45e"),Gy:BigInt("0xc19139cb84c680a6e14116da06056174a0cfa121e6e5c2450f87d64fc000001")},ls=Wt(Yt(Zo),fs),y0=Nt("096b36a5804bfacef1691e173c366a47ff5ba84a44f26ddd7e8d9f79d5b42df0");var Ko={p:BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377"),a:BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9"),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1)},hs=wt(yt(Ko),Ut),Mo={p:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53"),a:BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826"),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1)},bs=wt(yt(Mo),Le),Vo={p:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3"),a:BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca"),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1)},xs=wt(yt(Vo),Dt);var Po={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Xo={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},ps={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")};var jo=yt(Po),ms=wt(jo,Ut);var Yo=yt(Xo),gs=wt(Yo,Le);var Wo=it(ps.n,{allowedLengths:[65,66]}),zo=yt(ps,{Fn:Wo}),ys=wt(zo,Dt);var Pe={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},$o={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Qo=BigInt(0),Dn=BigInt(2);function Fo(e){let t=Pe.p,r=BigInt(3),n=BigInt(6),s=BigInt(11),o=BigInt(22),f=BigInt(23),c=BigInt(44),i=BigInt(88),a=e*e*e%t,l=a*a*e%t,h=K(l,r,t)*l%t,d=K(h,r,t)*l%t,u=K(d,Dn,t)*a%t,p=K(u,s,t)*u%t,_=K(p,o,t)*p%t,y=K(_,c,t)*_%t,g=K(y,i,t)*y%t,S=K(g,c,t)*_%t,w=K(S,r,t)*l%t,O=K(w,f,t)*p%t,D=K(O,n,t)*a%t,C=K(D,Dn,t);if(!Ve.eql(Ve.sqr(C),e))throw new Error("Cannot find square root");return C}var Ve=it(Pe.p,{sqrt:Fo}),Qt=yt(Pe,{Fp:Ve,endo:$o}),vs=wt(Qt,Ut),ws={};function Ge(e,...t){let r=ws[e];if(r===void 0){let n=Ut(Nt(e));r=Y(n,n),ws[e]=r}return Ut(Y(r,...t))}var Nn=e=>e.toBytes(!0).slice(1),kn=e=>e%Dn===Qo;function qn(e){let{Fn:t,BASE:r}=Qt,n=t.fromBytes(e),s=r.multiply(n);return{scalar:kn(s.y)?n:t.neg(n),bytes:Nn(s)}}function Es(e){let t=Ve;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x \u2265 p");let r=t.create(e*e),n=t.create(r*e+BigInt(7)),s=t.sqrt(n);kn(s)||(s=t.neg(s));let o=Qt.fromAffine({x:e,y:s});return o.assertValidity(),o}var Se=qt;function _s(...e){return Qt.Fn.create(Se(Ge("BIP0340/challenge",...e)))}function Bs(e){return qn(e).bytes}function Jo(e,t,r=xt(32)){let{Fn:n}=Qt,s=L(e,void 0,"message"),{bytes:o,scalar:f}=qn(t),c=L(r,32,"auxRand"),i=n.toBytes(f^Se(Ge("BIP0340/aux",c))),a=Ge("BIP0340/nonce",i,o,s),{bytes:l,scalar:h}=qn(a),d=_s(l,o,s),u=new Uint8Array(64);if(u.set(l,0),u.set(n.toBytes(n.create(h+d*f)),32),!Ss(u,s,o))throw new Error("sign: Invalid signature produced");return u}function Ss(e,t,r){let{Fp:n,Fn:s,BASE:o}=Qt,f=L(e,64,"signature"),c=L(t,void 0,"message"),i=L(r,32,"publicKey");try{let a=Es(Se(i)),l=Se(f.subarray(0,32));if(!n.isValidNot0(l))return!1;let h=Se(f.subarray(32,64));if(!s.isValidNot0(h))return!1;let d=_s(s.toBytes(l),Nn(a),c),u=o.multiplyUnsafe(h).add(a.multiplyUnsafe(s.neg(d))),{x:p,y:_}=u.toAffine();return!(u.is0()||!kn(_)||p!==l)}catch{return!1}}var Is=(()=>{let r=(n=xt(48))=>qe(n,Pe.n);return{keygen:Ct(r,Bs),getPublicKey:Bs,sign:Jo,verify:Ss,Point:Qt,utils:{randomSecretKey:r,taggedHash:Ge,lift_x:Es,pointToBytes:Nn},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:32*2,seed:48}}})();var Kn={};Pn(Kn,{ed25519:()=>of,ed448:()=>ff,p256:()=>nf,p384:()=>rf,p521:()=>sf,x25519:()=>cf,x448:()=>af});var As="raw",Mt="jwk",tf="spki",Os="pkcs8",je=Os,Cn=tf;function At(){let e=globalThis?.crypto?.subtle;if(typeof e=="object"&&e!=null)return e;throw new Error("crypto.subtle must be defined")}function We(e,t){return async function(n){let s=await e();return{secretKey:s,publicKey:await t(s)}}}function ef(e){return Uint8Array.from(e.match(/(\w\w)/g),t=>Number.parseInt(t,16))}function Xe(e,t){if(t.type!==e)throw new Error(`invalid key type, expected ${e}`)}function Ye(e,t,r,n){let s=t?["deriveBits"]:["sign"],o=t?[]:["verify"],f=(d,u)=>u===Mt?d:new Uint8Array(d),c={async import(d,u){let p=await At().importKey(u,d,e,!0,o);return Xe("public",p),p},async export(d,u){Xe("public",d);let p=await At().exportKey(u,d);return f(p,u)},async convert(d,u,p){return c.export(await c.import(d,u),p)}},i={async import(d,u){let p=At(),_;if(u===As){let y=d,g=ef(n),S=new Uint8Array(g.length+y.length);S.set(g,0),S.set(y,g.length),_=await p.importKey(Os,S,e,!0,s)}else t&&u===Mt&&(d={...d,key_ops:s}),_=await p.importKey(u,d,e,!0,s);return Xe("private",_),_},async export(d,u){let p=At();if(Xe("private",d),u===As){let g=(await p.exportKey(Mt,d)).d.replace(/-/g,"+").replace(/_/g,"/"),S=g.length%4?"=".repeat(4-g.length%4):"",w=atob(g+S),O=Uint8Array.from(w,C=>C.charCodeAt(0)),D=new Uint8Array(r);return D.set(O,r-O.length),D}let _=await p.exportKey(u,d);return f(_,u)},async convert(d,u,p){return i.export(await i.import(d,u),p)}};async function a(d,u={}){let p=u.formatSec??je,_=u.formatPub??Cn,y=p===Mt?{...d}:await i.convert(d,p,Mt);return delete y.d,y.key_ops=o,_===Mt?y:c.convert(y,Mt,_)}async function l(d=je){let u=await At().generateKey(e,!0,s);return i.export(u.privateKey,d)}let h;return{pub:c,priv:i,async isSupported(){if(h!==void 0)return h;try{let d=At(),u=await d.generateKey(e,!0,s);return await i.export(u.privateKey,Mt),t&&await d.deriveBits({name:typeof e=="string"?e:e.name,public:u.publicKey},u.privateKey,8),h=!0}catch{return h=!1}},getPublicKey:a,keygen:We(l,a),utils:{randomSecretKey:l,convertPublicKey:c.convert,convertSecretKey:i.convert}}}function Rs(e,t){return{async sign(r,n,s={}){let o=await e.priv.import(n,s.formatSec??je),f=await At().sign(t,o,r);return new Uint8Array(f)},async verify(r,n,s,o={}){let f=await e.pub.import(s,o.formatPub??Cn);return await At().verify(t,f,r,n)}}}function Ts(e,t,r){return{async getSharedSecret(n,s,o={}){let f=await e.priv.import(n,o.formatSec||je),c=await e.pub.import(s,o.formatPub||Cn),i=await At().deriveBits({name:typeof t=="string"?t:t.name,public:c},f,8*r);return new Uint8Array(i)}}}function Zn(e,t,r,n){let s={name:"ECDH",namedCurve:e},o=Ye({name:"ECDSA",namedCurve:e},!1,r,n),f=Ye(s,!0,r,n);return Object.freeze({name:e,isSupported:o.isSupported,getPublicKey:o.getPublicKey,keygen:We(o.utils.randomSecretKey,o.getPublicKey),...Rs(o,{name:"ECDSA",hash:{name:t}}),...Ts(f,s,r),utils:o.utils})}function Ls(e,t,r){let n=Ye(e,!1,t,r);return Object.freeze({name:e,isSupported:n.isSupported,getPublicKey:n.getPublicKey,keygen:We(n.utils.randomSecretKey,n.getPublicKey),...Rs(n,{name:e}),utils:n.utils})}function Hs(e,t,r){let n=Ye(e,!0,t,r);return Object.freeze({name:e,isSupported:n.isSupported,getPublicKey:n.getPublicKey,keygen:We(n.utils.randomSecretKey,n.getPublicKey),...Ts(n,e,t),utils:n.utils})}var nf=Zn("P-256","SHA-256",32,"3041020100301306072a8648ce3d020106082a8648ce3d030107042730250201010420"),rf=Zn("P-384","SHA-384",48,"304e020100301006072a8648ce3d020106052b81040022043730350201010430"),sf=Zn("P-521","SHA-512",66,"3060020100301006072a8648ce3d020106052b81040023044930470201010442"),of=Ls("Ed25519",32,"302e020100300506032b657004220420"),ff=Ls("Ed448",57,"3047020100300506032b6571043b0439"),cf=Hs("X25519",32,"302e020100300506032b656e04220420"),af=Hs("X448",56,"3046020100300506032b656f043a0438");var df={bytesToHex:ht,concatBytes:Y,hexToBytes:ot};return ks(uf);})();
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
